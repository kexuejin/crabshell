import sys

# Key parts from config.rs
KEY_PART_1 = [0xef, 0x37, 0x2b, 0x49, 0x1a, 0x0e, 0xe1, 0xba, 0x16, 0x19, 0x50, 0xd9, 0xec, 0xef, 0xe0, 0x6a, 0x93, 0xc6, 0xe0, 0x2d, 0xc5, 0xd9, 0xad, 0x94, 0x81, 0x1f, 0x0b, 0x2a, 0x70, 0x3b, 0x29, 0x53];
KEY_PART_2 = [0xd0, 0xb0, 0x67, 0xdd, 0xb3, 0x2d, 0xd2, 0x60, 0x91, 0x90, 0x42, 0x23, 0x1f, 0x31, 0x70, 0x35, 0x6f, 0xa5, 0x9b, 0x13, 0xa4, 0x62, 0xdf, 0x40, 0xc1, 0xb9, 0x21, 0x6c, 0x23, 0x43, 0xd2, 0xec];

real_key_bytes = bytearray(32)
for i in range(32):
    real_key_bytes[i] = KEY_PART_1[i] ^ KEY_PART_2[i]

print(f"Real Key: {real_key_bytes.hex()}")

with open("libshell_extracted.so", "rb") as f:
    lib_data = f.read()

if real_key_bytes in lib_data:
    print("FAIL: Real key found in libshell.so in plaintext!")
    sys.exit(1)
else:
    print("SUCCESS: Real key NOT found in libshell.so")
    sys.exit(0)
